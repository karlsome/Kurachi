<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="floating card.css">
    <link rel="icon" type="image/png" href="src/favicon2.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>設備</title>
</head>
<body>
    <h1 class="centered">FREYA SYSTEM v3.9</h1>
    <nav>
        <a href="index.html">
            <img src="src/logo.png" alt="Logo">
        </a>
        <a href="index.html">工場</a>
        <a href="machine.html">設備</a>
    </nav>
    <div class="main-content">
        <h1 id="label1"></h1>
        <div id="containers" class="container"></div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const filterValue = urlParams.get('selected') || 'none';  // Default to 'none' if no parameter is found
        const dbURL = 'https://script.google.com/macros/s/AKfycbwBzPZgoNiUK_ez3AzK5FXFr8_AsmdBjCWGzulG3eh0cryirgVxtMzIF4ehh98QYdkpUg/exec';  // Replace with your actual database URL
        const label1 = document.getElementById('label1');
        label1.textContent = filterValue + "の設備選んでください:"; // Set the text content of the h1 element

        const serverURL = "https://kurachi.onrender.com";
        //const serverURL = "http://localhost:3000";

        

        if (filterValue === '天徳') {
            const containers = document.getElementById('containers');

            // Create card for スリット
            const slitCard = document.createElement('div');
            slitCard.classList.add('card');
            slitCard.addEventListener('click', () => {
                window.location.href = `SLIT Process iReporter.html?filter=${filterValue}`;
            });

            const slitImg = document.createElement('img');
            slitImg.src = 'src/machines/slit.jpg'; // Adjust the path to your image
            slitImg.alt = 'スリット';

            const slitLabel = document.createElement('div');
            slitLabel.classList.add('label');
            slitLabel.textContent = 'スリット';

            slitCard.appendChild(slitImg);
            slitCard.appendChild(slitLabel);
            containers.appendChild(slitCard);

            // Create card for SRS
            const srsCard = document.createElement('div');
            srsCard.classList.add('card');
            srsCard.addEventListener('click', () => {
                window.location.href = `SRS Process iReporter.html?filter=${filterValue}`;
            });

            const srsImg = document.createElement('img');
            srsImg.src = 'src/machines/srs.jpg'; // Adjust the path to your image
            srsImg.alt = 'SRS';

            const srsLabel = document.createElement('div');
            srsLabel.classList.add('label');
            srsLabel.textContent = 'SRS';

            srsCard.appendChild(srsImg);
            srsCard.appendChild(srsLabel);
            containers.appendChild(srsCard);

            // Create card for 検査
            const kensaCard = document.createElement('div');
            kensaCard.classList.add('card');
            kensaCard.addEventListener('click', () => {
                window.location.href = `newKensa iReporter.html?filter=${filterValue}`;
            });

            const kensaImg = document.createElement('img');
            kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
            kensaImg.alt = '検査';

            const kensaLabel = document.createElement('div');
            kensaLabel.classList.add('label');
            kensaLabel.textContent = '検査';

            kensaCard.appendChild(kensaImg);
            kensaCard.appendChild(kensaLabel);
            containers.appendChild(kensaCard);

        } else if (filterValue === '肥田瀬') {
        const containers = document.getElementById('containers');

        // Create card for プレス加工
        const pressCard = document.createElement('div');
        pressCard.classList.add('card');
        pressCard.addEventListener('click', () => {
            window.location.href = `Press Cutting iReporter.html?filter=${filterValue}`;
        });

        const pressImg = document.createElement('img');
        pressImg.src = 'src/machines/MANAS.jpg'; // Adjust the path to your image
        pressImg.alt = 'プレス加工';

        const pressLabel = document.createElement('div');
        pressLabel.classList.add('label');
        pressLabel.textContent = 'プレス加工';

        pressCard.appendChild(pressImg);
        pressCard.appendChild(pressLabel);
        containers.appendChild(pressCard);

        // Create card for 検査
        const kensaCard = document.createElement('div');
        kensaCard.classList.add('card');
        kensaCard.addEventListener('click', () => {
            window.location.href = `newKensa iReporter.html?filter=${filterValue}`;
        });

        const kensaImg = document.createElement('img');
        kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
        kensaImg.alt = '検査';

        const kensaLabel = document.createElement('div');
        kensaLabel.classList.add('label');
        kensaLabel.textContent = '検査';

        kensaCard.appendChild(kensaImg);
        kensaCard.appendChild(kensaLabel);
        containers.appendChild(kensaCard);

        // Create card for 肥田瀬QRスキャナー
        const hidaseCard = document.createElement('div');
        hidaseCard.classList.add('card');
        hidaseCard.addEventListener('click', () => {
            window.location.href = `hidase labelprinter.html?filter=${filterValue}`;
        });

        const hidaseImg = document.createElement('img');
        hidaseImg.src = 'src/qr-code.png'; // Adjust the path to your image
        hidaseImg.alt = '肥田瀬QRスキャナー';

        const hidaseLabel = document.createElement('div');
        hidaseLabel.classList.add('label');
        hidaseLabel.textContent = '肥田瀬QRスキャナー';

        hidaseCard.appendChild(hidaseImg);
        hidaseCard.appendChild(hidaseLabel);
        containers.appendChild(hidaseCard);
    }
    else if (filterValue === '第二工場') {
        const containers = document.getElementById('containers');

        // Create card for プレス加工
        const pressCard = document.createElement('div');
        pressCard.classList.add('card');
        pressCard.addEventListener('click', () => {
            window.location.href = `Press Cutting iReporter.html?filter=${filterValue}`;
        });

        const pressImg = document.createElement('img');
        pressImg.src = 'src/machines/MANAS.jpg'; // Adjust the path to your image
        pressImg.alt = 'プレス加工';

        const pressLabel = document.createElement('div');
        pressLabel.classList.add('label');
        pressLabel.textContent = 'プレス加工';

        pressCard.appendChild(pressImg);
        pressCard.appendChild(pressLabel);
        containers.appendChild(pressCard);

        // Create card for スリット
        const slitCard = document.createElement('div');
        slitCard.classList.add('card');
        slitCard.addEventListener('click', () => {
            window.location.href = `SLIT Process iReporter.html?filter=${filterValue}`;
        });

        const slitImg = document.createElement('img');
        slitImg.src = 'src/machines/slit.jpg'; // Adjust the path to your image
        slitImg.alt = 'スリット';

        const slitLabel = document.createElement('div');
        slitLabel.classList.add('label');
        slitLabel.textContent = 'スリット';

        slitCard.appendChild(slitImg);
        slitCard.appendChild(slitLabel);
        containers.appendChild(slitCard);

        // Create card for 検査
        const kensaCard = document.createElement('div');
        kensaCard.classList.add('card');
        kensaCard.addEventListener('click', () => {
            window.location.href = `newKensa iReporter.html?filter=${filterValue}`;
        });

        const kensaImg = document.createElement('img');
        kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
        kensaImg.alt = '検査';

        const kensaLabel = document.createElement('div');
        kensaLabel.classList.add('label');
        kensaLabel.textContent = '検査';

        kensaCard.appendChild(kensaImg);
        kensaCard.appendChild(kensaLabel);
        containers.appendChild(kensaCard);

        // Create card for 第二工場 QRスキャナー (NEW)
        const qrCard = document.createElement('div');
        qrCard.classList.add('card');
        qrCard.addEventListener('click', () => {
            window.location.href = `HABA request.html?filter=${filterValue}`;
        });

        const qrImg = document.createElement('img');
        qrImg.src = 'src/qr-code.png'; // Adjust the path to your QR image
        qrImg.alt = '第二工場 QRスキャナー';

        const qrLabel = document.createElement('div');
        qrLabel.classList.add('label');
        qrLabel.textContent = '第二工場 QRスキャナー';

        qrCard.appendChild(qrImg);
        qrCard.appendChild(qrLabel);
        containers.appendChild(qrCard);
    }

    else if (filterValue === '倉知') {
        const containers = document.getElementById('containers');

        // Create card for プレス加工
        const pressCard = document.createElement('div');
        pressCard.classList.add('card');
        pressCard.addEventListener('click', () => {
            window.location.href = `Press Cutting iReporter.html?filter=${filterValue}`;
        });

        const pressImg = document.createElement('img');
        pressImg.src = 'src/machines/NCC01.jpg'; // Adjust the path to your image
        pressImg.alt = 'NC加工';

        const pressLabel = document.createElement('div');
        pressLabel.classList.add('label');
        pressLabel.textContent = 'NC加工';

        pressCard.appendChild(pressImg);
        pressCard.appendChild(pressLabel);
        containers.appendChild(pressCard);

        // Create card for 検査
        const kensaCard = document.createElement('div');
        kensaCard.classList.add('card');
        kensaCard.addEventListener('click', () => {
            window.location.href = `newKensa iReporter.html?filter=${filterValue}`;
        });

        const kensaImg = document.createElement('img');
        kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
        kensaImg.alt = '検査';

        const kensaLabel = document.createElement('div');
        kensaLabel.classList.add('label');
        kensaLabel.textContent = '検査';

        kensaCard.appendChild(kensaImg);
        kensaCard.appendChild(kensaLabel);
        containers.appendChild(kensaCard);
    } 
        else if (filterValue === '第一工場') {
        const containers = document.getElementById('containers');

        // Create card for Laser加工
        const pressCard = document.createElement('div');
        pressCard.classList.add('card');
        pressCard.addEventListener('click', () => {
            window.location.href = `Press Cutting iReporter.html?filter=${filterValue}`;
        });

        const pressImg = document.createElement('img');
        pressImg.src = 'src/machines/ALC01.jpg'; // Adjust the path to your image
        pressImg.alt = 'レーザー加工';

        const pressLabel = document.createElement('div');
        pressLabel.classList.add('label');
        pressLabel.textContent = 'NC加工';

        pressCard.appendChild(pressImg);
        pressCard.appendChild(pressLabel);
        containers.appendChild(pressCard);

        // Create card for 検査
        const kensaCard = document.createElement('div');
        kensaCard.classList.add('card');
        kensaCard.addEventListener('click', () => {
            window.location.href = `newKensa iReporter.html?filter=${filterValue}`;
        });

        const kensaImg = document.createElement('img');
        kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
        kensaImg.alt = '検査';

        const kensaLabel = document.createElement('div');
        kensaLabel.classList.add('label');
        kensaLabel.textContent = '検査';

        kensaCard.appendChild(kensaImg);
        kensaCard.appendChild(kensaLabel);
        containers.appendChild(kensaCard);

        // Create card for 粘着
        const nenchakuCard = document.createElement('div');
        nenchakuCard.classList.add('card');
        nenchakuCard.addEventListener('click', () => {
            window.location.href = `firstKojoLabelPrinter.html?filter=${filterValue}`;
        });

        const nenchakuImg = document.createElement('img');
        nenchakuImg.src = 'src/machines/nenchaku.jpg'; // Adjust the path to your image
        nenchakuImg.alt = '粘着';

        const nenchakuLabel = document.createElement('div');
        nenchakuLabel.classList.add('label');
        nenchakuLabel.textContent = '粘着';

        nenchakuCard.appendChild(nenchakuImg);
        nenchakuCard.appendChild(nenchakuLabel);
        containers.appendChild(nenchakuCard);

        // Create card for CSVアップロード
        const csvCard = document.createElement('div');
        csvCard.classList.add('card');
        csvCard.addEventListener('click', () => {
            window.location.href = `csvUploader.html?filter=${filterValue}`;
        });

        const csvImg = document.createElement('img');
        csvImg.src = 'src/machines/csv.jpg'; // Adjust the path to your image
        csvImg.alt = 'CSVアップロード';

        const csvLabel = document.createElement('div');
        csvLabel.classList.add('label');
        csvLabel.textContent = 'CSVアップロード';

        csvCard.appendChild(csvImg);
        csvCard.appendChild(csvLabel);
        containers.appendChild(csvCard);
    }

    else if (filterValue === 'SCNA') {
        const containers = document.getElementById('containers');

        // Create card for プレス加工
        const pressCard = document.createElement('div');
        pressCard.classList.add('card');
        pressCard.addEventListener('click', () => {
            window.location.href = `Press Cutting iReporter English.html?filter=${filterValue}`;
        });

        const pressImg = document.createElement('img');
        pressImg.src = 'src/machines/NCC01.jpg'; // Adjust the path to your image
        pressImg.alt = 'NC加工';

        const pressLabel = document.createElement('div');
        pressLabel.classList.add('label');
        pressLabel.textContent = 'NC CUTTING PROCESS';

        pressCard.appendChild(pressImg);
        pressCard.appendChild(pressLabel);
        containers.appendChild(pressCard);

        // Create card for PRESS CUTTING PROCESS
        const pressCuttingCard = document.createElement('div');
        pressCuttingCard.classList.add('card');
        pressCuttingCard.addEventListener('click', () => {
            window.location.href = `Press Cutting iReporter English.html?filter=${filterValue}`;
        });

        const pressCuttingImg = document.createElement('img');
        pressCuttingImg.src = 'src/machines/MANAS.jpg'; // Adjust the path to your image
        pressCuttingImg.alt = 'プレス加工';

        const pressCuttingLabel = document.createElement('div');
        pressCuttingLabel.classList.add('label');
        pressCuttingLabel.textContent = 'PRESS CUTTING PROCESS';

        pressCuttingCard.appendChild(pressCuttingImg);
        pressCuttingCard.appendChild(pressCuttingLabel);
        containers.appendChild(pressCuttingCard);

        // Create card for SRS
        const srsCard = document.createElement('div');
            srsCard.classList.add('card');
            srsCard.addEventListener('click', () => {
                window.location.href = `SRS Process iReporter English.html?filter=${filterValue}`;
            });

            const srsImg = document.createElement('img');
            srsImg.src = 'src/machines/srs.jpg'; // Adjust the path to your image
            srsImg.alt = 'SRS';

            const srsLabel = document.createElement('div');
            srsLabel.classList.add('label');
            srsLabel.textContent = 'SRS';

            srsCard.appendChild(srsImg);
            srsCard.appendChild(srsLabel);
            containers.appendChild(srsCard);

        // Create card for 検査
        const kensaCard = document.createElement('div');
        kensaCard.classList.add('card');
        kensaCard.addEventListener('click', () => {
            window.location.href = `newKensa iReporter English.html?filter=${filterValue}`;
        });

        const kensaImg = document.createElement('img');
        kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
        kensaImg.alt = '検査';

        const kensaLabel = document.createElement('div');
        kensaLabel.classList.add('label');
        kensaLabel.textContent = 'INSPECTION';

        kensaCard.appendChild(kensaImg);
        kensaCard.appendChild(kensaLabel);
        containers.appendChild(kensaCard);
        
    } 
    else if (filterValue === '小瀬') {
        const containers = document.getElementById('containers');

        // Create card for プレス加工
        const pressCard = document.createElement('div');
        pressCard.classList.add('card');
        pressCard.addEventListener('click', () => {
            window.location.href = `chooseMachine.html?filter=${filterValue}`;
        });

        const pressImg = document.createElement('img');
        pressImg.src = 'src/machines/NCC01.jpg'; // Adjust the path to your image
        pressImg.alt = 'NC加工';

        const pressLabel = document.createElement('div');
        pressLabel.classList.add('label');
        pressLabel.textContent = 'NC加工';

        pressCard.appendChild(pressImg);
        pressCard.appendChild(pressLabel);
        containers.appendChild(pressCard);

        // Create card for 検査
        const kensaCard = document.createElement('div');
        kensaCard.classList.add('card');
        kensaCard.addEventListener('click', () => {
            window.location.href = `newKensa iReporter.html?filter=${filterValue}`;
        });

        const kensaImg = document.createElement('img');
        kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
        kensaImg.alt = '検査';

        const kensaLabel = document.createElement('div');
        kensaLabel.classList.add('label');
        kensaLabel.textContent = '検査';

        kensaCard.appendChild(kensaImg);
        kensaCard.appendChild(kensaLabel);
        containers.appendChild(kensaCard);
    } 
    else if (filterValue === 'NFH') {
        const containers = document.getElementById('containers');

        // Create card for プレス加工
        const pressCard = document.createElement('div');
        pressCard.classList.add('card');
        pressCard.addEventListener('click', () => {
            window.location.href = `Press Cutting iReporter.html?filter=${filterValue}`;
        });

        const pressImg = document.createElement('img');
        pressImg.src = 'src/machines/MANAS.jpg'; // Adjust the path to your image
        pressImg.alt = 'プレス加工';

        const pressLabel = document.createElement('div');
        pressLabel.classList.add('label');
        pressLabel.textContent = 'プレス / レーザー 加工';

        pressCard.appendChild(pressImg);
        pressCard.appendChild(pressLabel);
        containers.appendChild(pressCard);

        // Create card for 検査
        const kensaCard = document.createElement('div');
        kensaCard.classList.add('card');
        kensaCard.addEventListener('click', () => {
            window.location.href = `newKensa iReporter.html?filter=${filterValue}`;
        });

        const kensaImg = document.createElement('img');
        kensaImg.src = 'src/machines/kensa.jpg'; // Adjust the path to your image
        kensaImg.alt = '検査';

        const kensaLabel = document.createElement('div');
        kensaLabel.classList.add('label');
        kensaLabel.textContent = '検査';

        kensaCard.appendChild(kensaImg);
        kensaCard.appendChild(kensaLabel);
        containers.appendChild(kensaCard);
    } 
        
        
        else {
            fetch(`${dbURL}?filter=${filterValue}`)
                .then(response => response.json())
                .then(data => {
                    const containers = document.getElementById('containers');
                    
                    // Normal case, display cards based on fetched data
                    data.forEach((list) => {
                        const card = document.createElement('div');
                        card.classList.add('card');
                        card.addEventListener('click', () => {
                            window.location.href = `nippo.html?selected=${list}&filter=${filterValue}`;
                        });

                        const img = document.createElement('img');
                        if (list === "自動プレス機") {
                            img.src = `src/machines/jido.jpg`;
                        } else {
                            img.src = `src/machines/${list}.jpg`;
                        }
                        img.alt = list;

                        const label = document.createElement('div');
                        label.classList.add('label');
                        label.textContent = list;
                        label.addEventListener('click', (event) => {
                            event.stopPropagation();
                            window.location.href = `nippo.html?selected=${list}&filter=${filterValue}`;
                        });

                        card.appendChild(img);
                        card.appendChild(label);
                        containers.appendChild(card);
                    });

                    // Add the additional card for QR code scanning
                    const qrCard = document.createElement('div');
                    qrCard.classList.add('card');
                    qrCard.addEventListener('click', () => {
                        const popup = window.open('popup.html', 'QR Scanner', 'width=400,height=300');

                        window.addEventListener('message', function(event) {
                            if (event.origin === window.location.origin) {
                                const BarcodeValue = event.data;
                                console.log(`QR Code detected: ${BarcodeValue}`);

                                // Check if the scanned value is in the list
                                if (data.includes(BarcodeValue)) {
                                    // Redirect to nippo.html with the QR code value as filter
                                    window.location.href = `nippo.html?selected=${BarcodeValue}&filter=${filterValue}`;
                                } else {
                                    alert('Invalid QR Code');
                                }
                            }
                        });
                    });

                    const qrImg = document.createElement('img');
                    qrImg.src = 'src/qr-code.png';  // Path to your QR code image
                    qrImg.alt = 'QR Code Scanner';

                    const qrLabel = document.createElement('div');
                    qrLabel.classList.add('label');
                    qrLabel.textContent = 'Scan Machine!';

                    qrCard.appendChild(qrImg);
                    qrCard.appendChild(qrLabel);
                    containers.appendChild(qrCard);

                    // Add the additional card for Kensa Only
                    const kensaOnlyCard = document.createElement('div');
                    kensaOnlyCard.classList.add('card');
                    kensaOnlyCard.addEventListener('click', () => {
                        window.location.href = `choose.html?selected=${filterValue}`;
                    });

                    const kensaImg = document.createElement('img');
                    kensaImg.src = 'src/machines/kensa.jpg';  // Path to your Kensa image
                    kensaImg.alt = '検査のみ';

                    const kensaLabel = document.createElement('div');
                    kensaLabel.classList.add('label');
                    kensaLabel.textContent = '検査のみ';

                    kensaOnlyCard.appendChild(kensaImg);
                    kensaOnlyCard.appendChild(kensaLabel);
                    containers.appendChild(kensaOnlyCard);
                })
                .catch(error => console.error('Error fetching data:', error));
        }
    </script>
</body>
</html>